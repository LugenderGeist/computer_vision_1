# computer_vision_1
## Введение
  Данная работа выполнена с целью ознакомления с некоторыми базовыми функциями обработки изображений: в процессе работы необходимо реализовать следующие функции обработки изображений:  
- Эррозия
- Дилатация
- Медианный фильтр
- Фильтр Гаусса
- Бинаризация
- Корректировка освещения

Работа функций будет проверяться на картинке Эдварда Мунка "Крик"  
![крик](https://github.com/LugenderGeist/computer_vision_1/blob/main/scream.jpg)
  ## Паддинг
  Прежде чем приступить к обработке изображений необходимо сделать так, чтобы в результате обработки не были потеряны данные. Для этого используется паддинг - добавление дополнительных пикселей (или значений) вокруг границ изображения или массива данных. Когда применяются морфологические преобразования или фильтры, пиксели у границ изображения могут быть обработаны некорректно, относительно основного изображения, или в процессе может сильно измениться размер изображения, что, естественно, нежелательно. В данном случае будем использовать mirror padding - процесс добавления пикселей зеркальных тем, что находятся на границе: это позволяет сохранить внешний вид изображения, что в свою очередь позволит избежать некорректной обработки пикселей.
  ## Морфологические операции
  Морфологическая обработка изображений — это набор операций, основанных на теории математической морфологии, которые используются для анализа и преобразования геометрических структур на изображении. Эти операции позволяют изменять формы объектов, удалять шумы, выделять границы или заполнять пробелы. Основная идея морфологической обработки заключается в использовании структурирующего элемента (ядра), который определяет форму и размер области, над которой выполняется операция.
  ### Эрозия
  Эрозия - это операция морфологической обработки изображений, которая используется для уменьшения светлых областей и увеличения темных: таким образом можно избавиться от определенного вида шумов или убрать с изображения незначительные светлые детали, неважные для выполнения задачи. Так как суть функции в "затемнении", то в процессе прохода ядра по изображению центральный пиксель сравнивается с окружающими и в случае нахождения более темного - центральный пиксель заменяется на него.  
![Эрозия](https://github.com/LugenderGeist/computer_vision_1/blob/main/erosion.PNG)
  ### Дилатация
  Дилатация - также операция морфологической обработки изображений, но используется для уменьшения темных областей и увеличения светлых. Принцип работы такой функции аналогичен: центральный пиксель в обрабатываемой ядром матрице заменится на более светлый, если такой появиляется в процессе обработки ядром части изображения.  
![Дилатация](https://github.com/LugenderGeist/computer_vision_1/blob/main/dilation.PNG)
  ## Фильтры
  Фильтр - это математическая операция, применяемая, в данном случае, к изображению с целью получения большей информации: это может быть удаление шумов, сглаживание изображения, определение границ объекта и т.п. В данной работе реализуем два фильтра: медианный и Гаусса.  
  ### Медианный фильтр
  Медианный фильтр - это метод обработки изображений, который используется для устранения шума при сохранении чётких границ объектов. Медианный фильтр не размывает изображение, а заменяет значение каждого пикселя на медиану значений в его окрестности.  
  Принцип работы:  
- Выбирается окно определённого размера, которое перемещается по всему изображению.
- Для каждого положения окна все пиксели внутри него сортируются по яркости.
- Центральный пиксель окна заменяется на медианное значение из отсортированного списка.  
![Медианный фильтр](https://github.com/LugenderGeist/computer_vision_1/blob/main/median.PNG)
  ### Фильтр Гаусса
  Фильтр Гаусса — это линейный фильтр, который применяется для сглаживания изображений. Он основывается на математической функции нормального (Гауссова) распределения и используется для уменьшения шумов, размытия изображений и подготовки данных для последующей обработки. В этом фильтре функция Гаусса используется для вычисления преобразования, применяемого к каждому пикселю изображения. Новое значение каждого пикселя устанавливается равным средневзвешенному значению окрестности этого пикселя. Значение исходного пикселя получает наибольший вес, а соседние пиксели получают меньшие веса по мере увеличения их расстояния до исходного пикселя, что и приводит к размытию.  
![Фильтр Гаусса](https://github.com/LugenderGeist/computer_vision_1/blob/main/gaussian.PNG)
  ## Бинаризация
  Бинаризация — это процесс преобразования изображения с множеством уровней яркости в изображение с двумя уровнями яркости: черный и белый (0 и 255). Для того, чтобы применить функцию бинаризации - переведем изображение в grayscale.  Это необходимо, так как каждый из каналов RGB находится в пределах от 0 до 255, соответственно, при применении бинаризации к цветному изображению будут получены максимальные и минимальные значения для каждого из каналов RGB. Переведем изображение в grayscale:  
![grayscale](https://github.com/LugenderGeist/computer_vision_1/blob/main/grayscale.PNG)
  Соответственно, функцию бинаризации применим к изображению в grayscale.  
![Бинаризация](https://github.com/LugenderGeist/computer_vision_1/blob/main/binarisation.PNG)
  *Результат применения бинаризации к цветному изображению*  
![Бинаризация_2](https://github.com/LugenderGeist/computer_vision_1/blob/main/binarisation_2.PNG)
  ## Корректировка освещения
  Так как изображения могут быть собраны в совершенно разных условиях - их качество тоже может быть совершенно разным. В том числе, на изображениях могут быть засветы или очень темные участки, в которых нельзя разглядеть необходимые объекты. Для выравнения освещения используются различные способы: среди них корректировка с помощью гамма-функции, которая пишется одной строкой и не дает видимых результатов. По этой причине было принято решение выбрать способ корректировки посложнее, но с заметными результатами.  
  Корректировка освещения была выполнена с помощью метода глобального выравнивания гистограммы (GHE). Этот метод увеличивает контрастность изображения, распределяя интенсивности пикселейпо всему диапазону яркости (от 0 до 255).  
  Первоначально необходимо перебрать все пиксели изображения и рассчитать количество пикселей для каждого уровня яркости (от 0 до 255). Далее вычисляется накопленная функция распределения (Cumulative Distribution Function, CDF), которая нормируется, чтобы значения были в диапазоне от 0 до 255. Создается таблица преобразования (mapping_table), по которой каждый пиксель заменяется на новый соответствующий.  
![Корректировка](https://github.com/LugenderGeist/computer_vision_1/blob/main/corrected.PNG)
# Заключение
В результате работы были реализованы такие функции морфологической обработки изображений, как эрозия и дилатация, такие применимые к изображениям фильтры, как медианный фильтр и фильтр Гаусса, а также были изучены функции бинаризации и корректировки освещения с помощью метода глобального выравния гистограммы. Данные функции необходимы для преобработки изображений для их последующего использования в различных задачах компьютерного зрения.
